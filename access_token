<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login con Discord</title>
</head>
<body>

  <h1>Inicia sesi贸n con Discord</h1>
  <a href="https://discord.com/oauth2/authorize?client_id=1392829126372622420&redirect_uri=http://localhost:800&response_type=code&scope=identify">
    <button>Loguearse con Discord</button>
  </a>

  <div id="user-info" style="display: none;">
    <h2>Usuario de Discord</h2>
    <img id="user-avatar" src="" alt="Avatar" />
    <p><strong>Nombre:</strong> <span id="user-name"></span></p>
    <p><strong>ID:</strong> <span id="user-id"></span></p>
    <p><strong>Rol:</strong> <span id="user-role"></span></p>
  </div>

  <script>
    // Obtener el code de la URL
    const urlParams = new URLSearchParams(window.location.search);
    const code = urlParams.get("code");

    if (code) {
      // Mostrar secci贸n de usuario
      document.getElementById("user-info").style.display = "block";

      // Simular obtenci贸n del access_token (solo para pruebas)
      fetch(' https://discord.com/api/oauth2/token ', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        body: new URLSearchParams({
          client_id: '1392829126372622420', // Reemplaza por tu CLIENT_ID
          client_secret: 'TU_CLIENT_SECRET', // Reemplaza por tu DISCORD_SECRET
          grant_type: 'authorization_code',
          code,
          redirect_uri: 'http://localhost:800'
        })
      })
      .then(res => res.json())
      .then(data => {
        const { access_token } = data;

        // Obtener informaci贸n del usuario
        fetch('https://discord.com/api/users/ @me', {
          headers: {
            'Authorization': 'Bearer ' + access_token
          }
        })
        .then(res => res.json())
        .then(user => {
          document.getElementById("user-name").textContent = user.username;
          document.getElementById("user-id").textContent = user.id;
          document.getElementById("user-role").textContent = 'Administrador';
          document.getElementById("user-avatar").src = `https://cdn.discordapp.com/avatars/ ${user.id}/${user.avatar}.png`;
        });
      })
      .catch(err => console.error('Error al obtener access_token:', err));
    }
  </script>

</body>
</html>
